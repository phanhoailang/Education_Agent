/* =========================================================================
   Edu Mate – Chat + Plan Canvas
   * Khi CHƯA mở Plan: Chat ở giữa trang, rộng tối đa 55 vw (~ nửa màn).
   * Khi mở Plan: Chat 40 %, Plan 60 %.
   * JS sẽ luôn đồng bộ chiều cao 2 cột.
   * Nền gradient tím giống Form.
   ========================================================================= */

:root{
  --gap:             16px;
  --card-radius:     14px;
  --border:          #e5e7eb;
  --text:            #111827;
  --muted:           #6b7280;
  --primary:         #7c3aed;      /* tím */
  --success:         #10b981;

  /* Tỉ lệ khi mở panel (Chat : Plan = 2 : 3 ≈ 40 : 60) */
  --chat-col:        2;
  --plan-col:        3;

  /* Gradient tím */
  --grad-1:#6d28d9;
  --grad-2:#7c3aed;
  --grad-3:#8b5cf6;
}

/* ===== NỀN ============================================================== */
html,body{height:100%;}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;
  color:var(--text);
  background:
    radial-gradient(100% 50% at 0 0,rgba(255,255,255,.10)0%,rgba(255,255,255,0)60%),
    linear-gradient(135deg,var(--grad-1)0%,var(--grad-2)35%,var(--grad-3)100%);
  background-attachment:fixed;
}

/* ===== HEADER =========================================================== */
.header{
  position:sticky;top:0;z-index:10;
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 14px;
  background:rgba(255,255,255,.9);backdrop-filter:blur(8px);
  border-bottom:1px solid rgba(255,255,255,.7);
  box-shadow:0 8px 24px rgba(0,0,0,.06);
  border-radius:0 0 16px 16px;
  max-width:min(1600px,96vw);
  margin:12px auto 0;
}
.header h1{margin:0;font-size:20px;font-weight:800;letter-spacing:.2px;}
.back-btn{
  background:#fff;border:1px solid var(--border);border-radius:10px;
  padding:6px 10px;color:#374151;text-decoration:none;
}
.back-btn:hover{box-shadow:0 4px 10px rgba(0,0,0,.08);}
.status-indicator{display:flex;align-items:center;gap:8px;font-size:13px;color:#059669;}
.status-dot{width:8px;height:8px;border-radius:999px;background:var(--success);animation:pulse 1.6s infinite;}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(16,185,129,.5);}70%{box-shadow:0 0 0 10px rgba(16,185,129,0);}100%{box-shadow:0 0 0 0 rgba(16,185,129,0);}}

/* ===== GRID LAYOUT ====================================================== */
#page{
  display:grid;
  gap:var(--gap);
  align-items:stretch;
  width:100%;
  max-width:min(1600px,96vw);
  margin:12px auto 24px;
  /* 1 cột: Chat ở giữa, max 55 vw */
  grid-template-columns:minmax(auto,55vw);
  justify-content:center;
}
#page>.col{min-width:0;}
.col-panel{align-self:stretch;display:none;opacity:0;transform:translateY(4px);transition:.2s ease;}

body.panel-open #page,
#page.is-open{
  grid-template-columns:minmax(0,var(--chat-col)fr) minmax(0,var(--plan-col)fr);
  justify-content:stretch;
}
body.panel-open #panelCol,
#page.is-open .col-panel{display:block!important;opacity:1;transform:none;}
#page.is-open #panelCol{grid-column:2;}

/* ===== CHAT ============================================================== */
.col-chat .chat-container{
  background:#fff;border:1px solid rgba(255,255,255,.6);border-radius:14px;
  box-shadow:0 12px 32px rgba(0,0,0,.08);padding:12px;
  display:flex;flex-direction:column;
  min-height:calc(100vh - 140px);      /* fallback trước khi JS set */
}
.chat-messages{flex:1 1 auto;display:flex;flex-direction:column;gap:12px;overflow:auto;}
.message{display:flex;gap:10px;}
.message-avatar{width:32px;height:32px;display:flex;align-items:center;justify-content:center;}
.message-content{
  background:#fff;border:1px solid var(--border);border-radius:12px;
  padding:10px 12px;box-shadow:0 6px 14px rgba(0,0,0,.04);
}

/* typing indicator */
.typing-indicator{display:flex;align-items:center;gap:8px;color:#6b7280;margin-top:8px;font-size:13px;}
.typing-dots{display:flex;gap:4px;}
.dot{width:6px;height:6px;border-radius:999px;background:#d1d5db;animation:blink 1.2s infinite;}
.dot:nth-child(2){animation-delay:.2s;}
.dot:nth-child(3){animation-delay:.4s;}
@keyframes blink{0%,80%,100%{opacity:.3;}40%{opacity:1;}}

/* Input */
.chat-input{
  display:flex;align-items:center;gap:8px;margin-top:8px;
  background:#fff;border:1px solid var(--border);border-radius:12px;padding:8px;
}
.action-btn{border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px;cursor:pointer;}
.input-field{flex:1;border:none;outline:none;padding:10px 12px;background:transparent;font-size:14px;}
.send-btn{border:1px solid var(--border);background:var(--primary);color:#fff;border-radius:10px;padding:8px 12px;cursor:pointer;}

/* ===== PLAN PANEL ======================================================= */
.plan-panel{
  background:#fff;border:1px solid rgba(255,255,255,.6);border-radius:var(--card-radius);
  box-shadow:0 12px 32px rgba(0,0,0,.10);
  display:flex;flex-direction:column;height:100%;overflow:hidden;
}
.plan-panel__header{
  position:sticky;top:0;z-index:2;
  display:grid;grid-template-columns:auto 1fr auto;align-items:center;
  gap:10px;padding:10px 14px;
  background:#ffffffd9;backdrop-filter:blur(8px);
  border-bottom:1px solid #eef2f7;
}
.plan-panel__nav{display:flex;gap:6px;}
.nav-tab{
  border:1px solid var(--border);background:#fff;color:#374151;
  padding:8px 12px;border-radius:10px;font-size:13px;cursor:pointer;
}
.nav-tab.active{background:var(--primary);color:#fff;border-color:var(--primary);}
.plan-panel__title{font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-left:6px;}
.plan-panel__actions{display:flex;gap:10px;flex-wrap:wrap;}
.plan-panel .btn{
  border:1px solid var(--border);background:#fff;color:#374151;
  padding:10px 16px;min-height:40px;font-size:14px;border-radius:12px;cursor:pointer;
  display:inline-flex;align-items:center;gap:8px;transition:.15s ease;
}
.plan-panel .btn.primary{background:var(--primary);color:#fff;border-color:var(--primary);font-weight:600;}
.plan-panel .btn.ghost{background:#f9fafb;}
.plan-panel .btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.10);}
.plan-panel__body{flex:1 1 auto;overflow:auto;padding:16px;background:#fafbfc;}

.doc{
  background:#fff;border:1px solid #eef2f7;border-radius:12px;
  padding:18px 20px;box-shadow:0 6px 16px rgba(0,0,0,.04);
}
.doc h1{font-size:22px;font-weight:800;margin:0 0 12px;}
.doc h2{font-size:18px;font-weight:700;margin:18px 0 8px;}
.doc h3{font-size:16px;font-weight:700;margin:14px 0 6px;}
.doc p{margin:8px 0;color:#1f2937;}
.doc ul{margin:8px 0 12px 22px;}
.doc li{margin:4px 0;}
.doc blockquote{border-left:3px solid var(--border);padding:8px 12px;background:#fcfcfd;color:#4b5563;border-radius:8px;}

/* ===== CARD TÓM TẮT trong chat ========================================= */
.plan-card{
  display:flex;gap:12px;border:1px solid var(--border);border-radius:12px;
  padding:12px;background:#f8fafc;cursor:pointer;
  transition:box-shadow .15s ease,transform .15s ease,border-color .15s ease;
}
.plan-card:hover{transform:translateY(-1px);box-shadow:0 8px 18px rgba(0,0,0,.06);border-color:#c7d2fe;}
.plan-card__icon{font-size:22px;}
.plan-card__title{font-weight:800;margin-bottom:6px;}
.plan-card__meta{list-style:none;padding:0;margin:0 0 8px;display:flex;gap:10px;flex-wrap:wrap;font-size:13px;color:#374151;}
.plan-card__meta li{display:flex;gap:6px;}
.plan-card__footer{display:flex;gap:8px;flex-wrap:wrap;}
.chip-btn{
  border:none;border-radius:10px;padding:6px 10px;font-size:12px;
  display:inline-flex;align-items:center;gap:6px;cursor:pointer;transition:.15s ease;
}
.chip-btn.view{background:#06b6d4;color:#fff;}
.chip-btn.edit{background:#10b981;color:#fff;}
.chip-btn:hover{transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,.12);}
