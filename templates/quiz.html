<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz - Edu Mate</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/quiz.css') }}?v=20250814" />

    <!-- MathJax cho LaTeX -->
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
            options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] }
        };
    </script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <!-- Header -->
    <div class="header">
        <a href="#" class="back-btn" onclick="goBack()">Quay l·∫°i</a>
        <h1>üìù Quiz - Edu Mate</h1>
        <div class="status-indicator">
            <div class="status-dot"></div><span>S·∫µn s√†ng</span>
        </div>
    </div>

    <!-- L∆∞·ªõi 2 c·ªôt: Chat (tr√°i) + Panel (ph·∫£i) -->
    <div class="page" id="page">
        <!-- C·ªôt Chat (hi·ªÉn th·ªã card) -->
        <div class="col col-chat">
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai">
                        <div class="message-avatar">ü§ñ</div>
                        <div class="message-content">
                            <div>Xin ch√†o! T√¥i ƒëang t·∫£i quiz c·ªßa b·∫°n...</div>
                            <div class="typing-indicator">
                                <span>ƒêang suy nghƒ©</span>
                                <div class="typing-dots">
                                    <div class="dot"></div>
                                    <div class="dot"></div>
                                    <div class="dot"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Input (tu·ª≥ ch·ªçn) -->
                <div class="chat-input">
                    <div class="input-actions"></div>
                    <input type="text" class="input-field" id="userInput" placeholder="Nh·∫≠p tin nh·∫Øn c·ªßa b·∫°n..."
                        disabled>
                    <button class="send-btn" id="sendBtn" disabled type="button">
                        <svg class="send-icon" viewBox="0 0 24 24">
                            <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- C·ªôt Panel Quiz -->
        <div class="col col-panel" id="panelCol">
            <section id="quizPanel" class="quiz-panel" aria-hidden="true">
                <div class="quiz-panel__header">
                    <div class="quiz-panel__nav">
                        <button class="nav-tab active" onclick="switchTab('chat')">Chat</button>
                        <button class="nav-tab" onclick="switchTab('quiz')">Quiz</button>
                    </div>
                    <div class="quiz-panel__title" id="quizPanelTitle"></div>
                    <div class="quiz-panel__actions">
                        <a id="panelDownloadLink" class="btn ghost" href="#" target="_blank" rel="noopener"
                            style="display:none;">‚¨áÔ∏è T·∫£i xu·ªëng</a>
                        <button class="btn ghost" onclick="copyQuizContent()">üìã Sao ch√©p</button>

                        <!-- Ch·ªânh s·ª≠a tr·ª±c ti·∫øp trong panel -->
                        <button class="btn primary" id="panelEditBtn" onclick="togglePanelEdit()">‚úèÔ∏è Ch·ªânh s·ª≠a</button>
                        <button class="btn primary" id="panelSaveBtn" onclick="savePanelEdit()" style="display:none;">üíæ
                            L∆∞u</button>
                        <button class="btn" id="panelCancelBtn" onclick="togglePanelEdit(false)"
                            style="display:none;">‚Ü©Ô∏é Hu·ª∑</button>

                        <button class="btn close-btn" onclick="closeQuizPanel()">‚úï</button>
                    </div>
                </div>

                <div class="quiz-panel__body" id="quizPanelBody">
                    <!-- Viewer/Editor s·∫Ω ƒë∆∞·ª£c render b·ªüi JS -->
                    <div class="doc" style="color:#9ca3af;">Ch∆∞a c√≥ quiz ƒë·ªÉ hi·ªÉn th·ªã</div>
                </div>
            </section>
        </div>
    </div>

    <!-- Libs render Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>

    <!-- D·ªØ li·ªáu server inject -->
    <script type="application/json" id="eduForm">{{ form_data | tojson | safe }}</script>
    <script type="application/json" id="quizContent">{{ quiz_content | tojson | safe }}</script>
    <script type="application/json" id="quizDownload">{{ quiz_download_url | tojson | safe }}</script>

    <script src="{{ url_for('static', filename='js/quiz.js') }}?v=20250814"></script>
</body>

</html>